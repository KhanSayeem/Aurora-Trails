@model TourismApp.Models.ViewModels.AgencyDashboardVM
@{
    ViewData["Title"] = "Agency Dashboard";
}

<section class="space-y-10">
    <div class="flex flex-col gap-4 md:flex-row md:items-center md:justify-between">
        <div class="space-y-2">
            <div class="inline-flex items-center gap-2 rounded-full bg-primary/10 px-3 py-1 text-xs font-semibold uppercase tracking-[0.3em] text-primary">Agency</div>
            <h1 class="heading">Welcome back, @Model.AgencyName</h1>
            <p class="section-subtitle">Monitor bookings, revenue, and guest sentiment in one calm workspace.</p>
        </div>
        <div class="flex flex-wrap gap-3">
            <a class="btn-primary px-5 py-2.5" asp-controller="Tours" asp-action="Create">
                Create new tour
            </a>
            <a class="btn-outline px-5 py-2.5" asp-controller="Tours" asp-action="MyPackages">
                Manage existing tours
            </a>
        </div>
    </div>

    <div class="grid gap-4 md:grid-cols-2 xl:grid-cols-4">
        <div class="card border border-transparent bg-white p-6 shadow-subtle">
            <p class="text-xs font-semibold uppercase tracking-wide text-slate-400">Total tours</p>
            <p class="mt-4 text-3xl font-semibold text-slate-900">@Model.TotalTours</p>
            <p class="mt-2 text-sm text-slate-500">Packages showcasing your agency portfolio.</p>
        </div>
        <div class="card border border-transparent bg-white p-6 shadow-subtle">
            <p class="text-xs font-semibold uppercase tracking-wide text-slate-400">Active bookings</p>
            <p class="mt-4 text-3xl font-semibold text-slate-900">@Model.ActiveBookings</p>
            <p class="mt-2 text-sm text-slate-500">Guests currently in your care.</p>
        </div>
        <div class="card border border-transparent bg-white p-6 shadow-subtle">
            <p class="text-xs font-semibold uppercase tracking-wide text-slate-400">Total revenue</p>
            <p class="mt-4 text-3xl font-semibold text-slate-900">$@Model.TotalRevenue.ToString("N0")</p>
            <p class="mt-2 text-sm text-slate-500">Confirmed earnings from bookings.</p>
        </div>
        <div class="card border border-transparent bg-white p-6 shadow-subtle">
            <p class="text-xs font-semibold uppercase tracking-wide text-slate-400">Pending reviews</p>
            <p class="mt-4 text-3xl font-semibold text-slate-900">@Model.PendingReviews</p>
            <p class="mt-2 text-sm text-slate-500">Awaiting responses from your team.</p>
        </div>
    </div>

    <div class="grid gap-8 xl:grid-cols-[2fr,1fr]">
        <div class="space-y-6">
            <div class="flex items-center justify-between">
                <div>
                    <h2 class="section-title">Recent bookings</h2>
                    <p class="section-subtitle">Latest activity aggregated across your tours.</p>
                </div>
                <a class="btn-outline px-4 py-2" asp-controller="Bookings" asp-action="Manage">View all</a>
            </div>

            @if (!Model.RecentBookings.Any())
            {
                <div class="empty-state">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-slate-300" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M8 9l4-4 4 4m0 6l-4 4-4-4" />
                    </svg>
                    <div>
                        <p class="text-base font-semibold text-slate-700">Your dashboard is warming up.</p>
                        <p class="text-sm text-slate-500">Create a new tour to start receiving bookings.</p>
                    </div>
                </div>
            }
            else
            {
                <div class="table-shell">
                    <table>
                        <thead>
                            <tr>
                                <th>Tour package</th>
                                <th>Booking date</th>
                                <th>Guests</th>
                                <th>Status</th>
                                <th>Revenue</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-slate-100">
                            @foreach (var booking in Model.RecentBookings)
                            {
                                var statusClass = booking.Status switch
                                {
                                    "Pending" => "badge badge-warning",
                                    "Confirmed" => "badge badge-info",
                                    "Completed" => "badge badge-success",
                                    "Cancelled" => "badge badge-danger",
                                    _ => "badge"
                                };
                                <tr>
                                    <td class="font-semibold text-slate-900">@booking.PackageTitle</td>
                                    <td>@booking.BookingDate.ToString("MMM dd, yyyy")</td>
                                    <td>@booking.Participants</td>
                                    <td><span class="@statusClass">@booking.Status</span></td>
                                    <td class="font-medium text-slate-900">$@booking.Revenue.ToString("N0")</td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            }
        </div>

        <div class="space-y-6">
            <div class="card p-6">
                <h2 class="section-title text-lg">Quick actions</h2>
                <p class="section-subtitle">Frequently performed agency tasks.</p>
                <div class="mt-6 grid gap-3">
                    <a class="btn-secondary justify-between px-4 py-2" asp-controller="Tours" asp-action="Create">
                        Create tour
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.6">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M12 4v16m8-8H4" />
                        </svg>
                    </a>
                    <a class="btn-outline justify-between px-4 py-2" asp-controller="Tours" asp-action="MyPackages">
                        Edit tours
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.6">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L7.5 20.5 3 21.5l1-4.5L16.732 3.732z" />
                        </svg>
                    </a>
                    <a class="btn-outline justify-between px-4 py-2" asp-controller="Bookings" asp-action="Manage">
                        Manage bookings
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.6">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M8 7V3m8 4V3m-9 8h10m-12 8h14a2 2 0 002-2V7a2 2 0 00-2-2h-3m-8 0H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                        </svg>
                    </a>
                    <a class="btn-outline justify-between px-4 py-2" asp-controller="Feedbacks" asp-action="Agency">
                        Customer feedback
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.6">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M7 8h10M7 12h6m-6 4h8m5 0V5a2 2 0 00-2-2H6a2 2 0 00-2 2v14l4-4h10a2 2 0 002-2z" />
                        </svg>
                    </a>
                    <a class="btn-outline justify-between px-4 py-2" asp-controller="Reports" asp-action="Index">
                        View reports
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.6">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M3 10h2l1 9h12l1-9h2M10 10v9m4-9v9m1-13V5a3 3 0 10-6 0v1" />
                        </svg>
                    </a>
                </div>
            </div>

            <div class="card p-6">
                <h2 class="section-title text-lg">Agency profile</h2>
                <p class="section-subtitle">Keep your details sharp for potential guests.</p>
                <div class="mt-6 flex items-center gap-4">
                    <div class="grid h-12 w-12 place-items-center rounded-xl bg-primary/10 text-primary">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.6">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M4 21v-6a4 4 0 014-4h8a4 4 0 014 4v6M16 7a4 4 0 10-8 0 4 4 0 008 0z" />
                        </svg>
                    </div>
                    <div>
                        <p class="text-base font-semibold text-slate-900">@Model.AgencyName</p>
                        <p class="text-sm text-slate-500">@Model.AgencyDescription</p>
                    </div>
                </div>
                <a class="mt-6 inline-flex items-center gap-2 text-sm font-semibold text-primary transition hover:text-primary/80" asp-controller="Profile" asp-action="Agency">
                    Update profile
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1.6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M17 8l4 4m0 0-4 4m4-4H3" />
                    </svg>
                </a>
            </div>
        </div>
    </div>
</section>